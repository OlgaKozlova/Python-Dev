# День 30 — Traceback и инварианты

## Что такое traceback

Traceback — это стек вызовов на момент возникновения исключения. Он показывает путь выполнения программы от точки входа до места, где дальнейшее выполнение стало невозможным.

Важно: traceback читается **снизу вверх**.

- последняя строка — _тип ошибки и сообщение_ (что произошло);
- строки выше — _путь выполнения_ (как мы туда пришли).

## Типичная ошибка мышления

Исправлять строку, где «упало», не проверив, **какое логическое предположение оказалось ложным**.

Traceback почти никогда не указывает на первопричину. Он указывает на **первое место, где Python отказался продолжать**.

## Инвариант

Инвариант — это условие, которое **должно быть истинным каждый раз**, когда выполнение доходит до конкретной строки кода.

Пример:

```python
arr[i + 1]
```

Инвариант этой строки:

- индекс `i + 1` находится в допустимых границах массива
- формально: `0 <= i + 1 < len(arr)`

Если код до этой строки **не гарантирует** данный инвариант — код логически некорректен.

## Связь traceback и инварианта

Каждая строка с цепочкой доступа:

```python
a.b.c
```

подразумевает инварианты:

- `a is not None`
- `a.b is not None`
- у `a.b` существует атрибут `c`

Traceback означает: **один из этих инвариантов не был обеспечен логикой выше**.

## Типы ошибок и их природа

- `AttributeError`, `TypeError` → ошибка алгоритма (ложная модель объекта)
- `IndexError`, `KeyError` → ошибка предположений о данных

## Практический вывод

- условия `if` / `while` формируют инварианты;
- тело кода вправе на них полагаться;
- если возник traceback — инвариант был ложным.
